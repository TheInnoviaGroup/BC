/*
 * Ext JS Library 1.0.1
 * Copyright(c) 2006-2007, Ext JS, LLC.
 * licensing@extjs.com
 * 
 * http://www.extjs.com/license
 */

Ext.grid.GridView3=function(_1){Ext.grid.GridView3.superclass.constructor.call(this);Ext.apply(this,_1);};Ext.extend(Ext.grid.GridView3,Ext.grid.AbstractGridView,{borderWidth:2,scrollOffset:17,autoFill:false,forceFit:false,init:function(_2){this.grid=_2;Ext.apply(this,this.ui);Ext.apply(this,this.modelHandler);Ext.apply(this,this.uiHandler);this.initData(_2.dataSource,_2.colModel);this.initUI(_2);},getColumnId:function(_3){return this.cm.getColumnId(_3);},renderHeaders:function(){var cm=this.cm,ts=this.templates;var ct=ts.hcell;var cb=[],sb=[],p={};for(var i=0,_b=cm.getColumnCount();i<_b;i++){p.id=cm.getColumnId(i);p.value=cm.getColumnHeader(i)||"";p.style=this.getColumnStyle(i,true);cb[cb.length]=ct.apply(p);}return ts.header.apply({cells:cb.join(""),tstyle:"width:"+this.getTotalWidth()+";"});},beforeUpdate:function(){this.grid.stopEditing();},updateHeaders:function(){this.mainHd.dom.innerHTML=this.renderHeaders();},focusRow:function(_c){this.focusCell(_c,0,false);},focusCell:function(_d,_e,_f){var el=this.ensureVisible(_d,_e,_f);if(el){this.focusEl.alignTo(el,"tl-tl");this.focusEl.focus.defer(1,this.focusEl);}},ensureVisible:function(row,col,_13){return;if(typeof row!="number"){row=row.rowIndex;}if(row<0&&row>=this.ds.getCount()){return;}col=(col!==undefined?col:0);while(this.cm.isHidden(col)){col++;}var el=this.getCell(row,col);if(!el){return;}var c=this.mainBody.dom;var _16=parseInt(el.offsetTop,10);var _17=parseInt(el.offsetLeft,10);var _18=_16+el.offsetHeight;var _19=_17+el.offsetWidth;var ch=c.clientHeight-this.mainHd.dom.offsetHeight;var _1b=parseInt(c.scrollTop,10);var _1c=parseInt(c.scrollLeft,10);var _1d=_1b+ch;var _1e=_1c+c.clientWidth;if(_16<_1b){c.scrollTop=_16;}else{if(_18>_1d){c.scrollTop=_18-ch;}}if(_13!==false){if(_17<_1c){c.scrollLeft=_17;}else{if(_19>_1e){c.scrollLeft=_19-c.clientWidth;}}}return el;},insertRows:function(dm,_20,_21,_22){if(_20==0&&_21==dm.getCount()-1){this.refresh();}else{if(!_22){this.fireEvent("beforerowsinserted",this,_20,_21);}this.renderRows(_20,_21);if(!_22){this.fireEvent("rowsinserted",this,_20,_21);this.stripeRows(_20);this.layout();}}},deleteRows:function(dm,_24,_25){if(dm.getRowCount()<1){this.fireEvent("beforerefresh",this);this.mainBody.update("");this.fireEvent("refresh",this);}else{this.fireEvent("beforerowsdeleted",this,_24,_25);this.removeRows(_24,_25);this.stripeRows(_24);this.fireEvent("rowsdeleted",this,_24,_25);}},getColumnStyle:function(col,_27){var _28=!_27?(this.cm.config[col].css||""):"";_28+="width:"+this.getColumnWidth(col)+";";if(this.cm.isHidden(col)){_28+="display:none;";}var _29=this.cm.config[col].align;if(_29){_28+="text-align:"+_29+";";}return _28;},getColumnWidth:function(col){var w=this.cm.getColumnWidth(col);if(typeof w=="number"){return (Ext.isBorderBox?w:w-this.borderWidth)+"px";}return w;},getTotalWidth:function(){return this.cm.getTotalWidth()+"px";},fitColumns:function(_2c,_2d,_2e){var cm=this.cm,_30,_31,i;var tw=cm.getTotalWidth(false);var aw=this.grid.container.getWidth(true)-this.scrollOffset;var _35=aw-tw;if(_35===0){return false;}var _36=cm.getColumnCount();var vc=cm.getColumnCount(true);var ac=vc-(typeof _2e=="number"?1:0);if(ac===0){ac=1;_2e=undefined;}if(_35>0){if(_35<vc){for(i=_36-1;i>=0;i--){if(!cm.isHidden(i)){cm.setColumnWidth(i,cm.getColumnWidth(i)+_35,true);break;}}}else{_30=_35%ac;_31=(_35-_30)/ac;for(i=0;i<_36;i++){if(i!==_2e&&!cm.isHidden(i)){cm.setColumnWidth(i,cm.getColumnWidth(i)+_31+(--ac==0?_30:0),true);}}}}else{_35*=-1;_30=_35%ac;_31=(_35-_30)/ac;for(i=0;i<_36;i++){if(i!==_2e&&!cm.isHidden(i)){cm.setColumnWidth(i,Math.max(1,cm.getColumnWidth(i)-(_31+(--ac==0?_30:0))),true);}}}if(ac!=vc&&(tw=cm.getTotalWidth(false))>aw){cm.setColumnWidth(_2e,Math.max(1,cm.getColumnWidth(_2e)-(tw-aw)),true);}if(_2c!==true){this.updateAllColumnWidths();}return true;},autoExpand:function(_39){var g=this.grid,cm=this.cm;if(!this.userResized&&g.autoExpandColumn){var tw=cm.getTotalWidth(false);var aw=this.grid.container.getWidth(true)-this.scrollOffset;if(tw!=aw){var ci=cm.getIndexById(g.autoExpandColumn);var _3f=cm.getColumnWidth(ci);var cw=Math.min(Math.max(((aw-tw)+_3f),g.autoExpandMin),g.autoExpandMax);if(cw!=_3f){cm.setColumnWidth(ci,cw,true);if(_39!==true){this.updateColumnWidth(ci,cw);}}}}},renderRows:function(_41,_42){var g=this.grid,cm=g.colModel,ds=g.dataSource,_46=g.stripeRows;var _47=cm.getColumnCount();if(ds.getCount()<1){return ["",""];}var cs=[];for(var i=0;i<_47;i++){var _4a=cm.getDataIndex(i);cs[i]={name:(typeof _4a=="undefined"?ds.fields.get(i).name:_4a),renderer:cm.getRenderer(i),id:cm.getColumnId(i),locked:cm.isLocked(i),style:this.getColumnStyle(i)};}_41=_41||0;_42=typeof _42=="undefined"?ds.getCount()-1:_42;var rs=ds.getRange(_41,_42);return this.doRender(cs,rs,ds,_41,_47,_46);},renderBody:function(){var _4c=this.renderRows();return this.templates.body.apply({rows:_4c});},refreshRow:function(_4d){var ds=this.ds,_4f;if(typeof _4d=="number"){_4f=_4d;_4d=ds.getAt(_4f);}else{_4f=ds.indexOf(_4d);}var cls=[];this.insertRows(ds,_4f,_4f,true);this.onRemove(ds,_4d,_4f+1,true);this.layout();this.fireEvent("rowupdated",this,_4f,_4d);},refresh:function(_51){this.fireEvent("beforerefresh",this);this.grid.stopEditing();var _52=this.renderBody();this.mainBody.update(_52);if(_51===true){this.updateHeaders();this.updateHeaderSortState();}this.stripeRows(0,true);this.layout();this.fireEvent("refresh",this);},updateHeaderSortState:function(){var _53=this.ds.getSortState();if(!_53){return;}this.sortState=_53;var _54=this.cm.findColumnIndex(_53.field);if(_54!=-1){var _55=_53.direction;this.updateSortIcon(_54,_55);}},destroy:function(){return;if(this.colMenu){this.colMenu.removeAll();Ext.menu.MenuMgr.unregister(this.colMenu);this.colMenu.getEl().remove();delete this.colMenu;}if(this.hmenu){this.hmenu.removeAll();Ext.menu.MenuMgr.unregister(this.hmenu);this.hmenu.getEl().remove();delete this.hmenu;}if(this.grid.enableColumnMove){var dds=Ext.dd.DDM.ids["gridHeader"+this.grid.container.id];if(dds){for(var dd in dds){if(!dds[dd].config.isTarget&&dds[dd].dragElId){var _58=dds[dd].dragElId;dds[dd].unreg();Ext.get(_58).remove();}else{if(dds[dd].config.isTarget){dds[dd].proxyTop.remove();dds[dd].proxyBottom.remove();dds[dd].unreg();}}if(Ext.dd.DDM.locationCache[dd]){delete Ext.dd.DDM.locationCache[dd];}}delete Ext.dd.DDM.ids["gridHeader"+this.grid.container.id];}}this.bind(null,null);Ext.EventManager.removeResizeListener(this.onWindowResize,this);},onDenyColumnHide:function(){},render:function(){var cm=this.cm;var _5a=cm.getColumnCount();if(this.grid.monitorWindowResize===true){Ext.EventManager.onWindowResize(this.onWindowResize,this,true);}if(this.autoFill){this.fitColumns(true,true);}else{if(this.forceFit){this.fitColumns(true,false);}else{if(this.grid.autoExpandColumn){this.autoExpand(true);}}}this.renderUI();this.layout();this.renderPhase2.defer(1,this);},renderPhase2:function(){this.refresh();},onWindowResize:function(){if(!this.grid.monitorWindowResize||this.grid.autoHeight){return;}this.layout();},sortAscText:"Sort Ascending",sortDescText:"Sort Descending",lockText:"Lock Column",unlockText:"Unlock Column",columnsText:"Columns"});
