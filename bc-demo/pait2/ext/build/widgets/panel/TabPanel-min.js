/*
 * Ext JS Library 1.0.1
 * Copyright(c) 2006-2007, Ext JS, LLC.
 * licensing@extjs.com
 * 
 * http://www.extjs.com/license
 */

Ext.TabPanel2=Ext.extend(Ext.Panel,{monitorResize:true,tabWidth:80,minTabWidth:30,resizeTabs:false,tabPosition:"top",elements:"body",baseCls:"x-tab-panel",frame:false,autoTabs:false,itemCls:"x-tab-item",activeTab:null,headerAsText:false,tabMargin:2,initComponent:function(){this.frame=false;Ext.TabPanel2.superclass.initComponent.call(this);this.addEvents({beforetabchange:true,tabchange:true,contextmenu:true});this.setLayout(new Ext.layout.CardLayout());if(this.tabPosition=="top"){this.elements+=",header";this.stripTarget="header";}else{this.elements+=",footer";this.stripTarget="footer";}if(!this.stack){this.stack=Ext.TabPanel2.AccessStack();}this.initItems();},render:function(){Ext.TabPanel2.superclass.render.apply(this,arguments);if(this.activeItem!==undefined){var _1=this.activeItem;delete this.activeItem;this.setActiveTab(_1);}},onRender:function(ct,_3){Ext.TabPanel2.superclass.onRender.call(this,ct,_3);var st=this[this.stripTarget];this.stripWrap=st.createChild({cls:"x-tab-strip-wrap",cn:{tag:"ul",cls:"x-tab-strip x-tab-strip-"+this.tabPosition}});this.strip=new Ext.Element(this.stripWrap.dom.firstChild);this.strip.createChild({cls:"x-clear"});this.body.addClass("x-tab-panel-body-"+this.tabPosition);if(!this.itemTpl){var tt=new Ext.Template("<li class=\"{cls}\" id=\"{id}\"><a class=\"x-tab-strip-close\" onclick=\"return false;\"></a>","<a class=\"x-tab-right\" href=\"#\" onclick=\"return false;\"><em class=\"x-tab-left\">","<span class=\"x-tab-strip-inner\"><span class=\"x-tab-strip-text\">{text}</span></span>","</em></a></li>");tt.disableFormats=true;tt.compile();Ext.TabPanel2.prototype.itemTpl=tt;}this.items.each(this.initTab,this);},initEvents:function(){Ext.TabPanel2.superclass.initEvents.call(this);this.on("add",this.onAdd,this);this.on("remove",this.onRemove,this);this.strip.on("mousedown",this.onStripMouseDown,this);this.strip.on("click",this.onStripClick,this);this.strip.on("contextmenu",this.onStripContextMenu,this);},findTargets:function(e){var _7=null;var _8=e.getTarget("li");if(_8){_7=this.getComponent(_8.id.split("__")[1]);}return {close:e.getTarget(".x-tab-strip-close"),item:_7,el:_8};},onStripMouseDown:function(e){e.preventDefault();if(e.button!=0){return;}var t=this.findTargets(e);if(t.close){this.remove(t.item);return;}if(t.item){this.setActiveTab(t.item);}},onStripClick:function(e){var t=this.findTargets(e);if(!t.close&&t.item&t.item!=this.activeItem){this.setActiveTab(t.item);}},onStripContextMenu:function(e){e.preventDefault();var t=this.findTargets(e);if(t.item){this.fireEvent("contextmenu",this,item,e);}},initTab:function(_f,_10){var _11=this.strip.dom.childNodes[_10];var cls=_f.closable?"x-tab-strip-closable":"";if(_f.disabled){cls+=" x-tab-strip-disabled";}var p={id:this.id+"__"+_f.id,text:_f.title,cls:cls};var el=_11?this.itemTpl.insertBefore(_11,p):this.itemTpl.append(this.strip,p);_f.on("disable",this.onItemDisabled,this);_f.on("enable",this.onItemEnabled,this);_f.on("titlechange",this.onItemTitleChanged,this);},onAdd:function(tp,_16,_17){this.initTab(_16,_17);if(this.resizeTabs&&this.rendered){this.autoSizeTabs();}},onRemove:function(tp,_19){var el=this.getTabEl(_19);if(el){el.parentNode.removeChild(el);}this.stack.remove(_19);if(_19==this.activeItem){var _1b=this.stack.next();if(_1b){this.setActiveTab(_1b);}}if(this.resizeTabs&&this.rendered){this.autoSizeTabs();}},onItemDisabled:function(_1c){var el=this.getTabEl(_1c);if(el){Ext.fly(el).addClass("x-tab-strip-disabled");}this.stack.remove(_1c);},onItemEnabled:function(_1e){var el=this.getTabEl(_1e);if(el){Ext.fly(el).removeClass("x-tab-strip-disabled");}},onItemTitleChanged:function(_20){var el=this.getTabEl(_20);if(el){Ext.fly(el).child("span.x-tab-strip-text",true).innerHTML=_20.title;}},getTabEl:function(_22){return document.getElementById(this.id+"__"+_22.id);},onResize:function(){Ext.TabPanel2.superclass.onResize.apply(this,arguments);if(this.resizeTabs){this.autoSizeTabs();}},autoSizeTabs:function(){var _23=this.items.length;var aw=this.stripWrap.dom.offsetWidth;if(!this.resizeTabs||_23<1||!aw){return;}var _25=Math.max(Math.min(Math.floor((aw-4)/_23)-this.tabMargin,this.tabWidth),this.minTabWidth);var lis=this.stripWrap.dom.getElementsByTagName("li");for(var i=0,len=lis.length;i<len;i++){var li=lis[i];var _2a=li.childNodes[1].firstChild.firstChild;var tw=li.offsetWidth;var iw=_2a.offsetWidth;_2a.style.width=(_25-(tw-iw))+"px";}},setActiveTab:function(_2d){_2d=this.getComponent(_2d);if(this.fireEvent("beforetabchange",this,_2d,this.activeItem)===false){return;}if(!this.rendered){this.activeItem=_2d;return;}if(this.activeItem!=_2d){if(this.activeItem){var _2e=this.getTabEl(this.activeItem);if(_2e){Ext.fly(_2e).removeClass("x-tab-strip-active");}}var el=this.getTabEl(_2d);Ext.fly(el).addClass("x-tab-strip-active");this.layout.setActiveItem(_2d);this.activeItem=_2d;this.stack.add(_2d);this.fireEvent("tabchange",this,_2d);}},getItem:function(_30){return this.getComponent(_30);}});Ext.TabPanel2.AccessStack=function(){var _31=[];return {add:function(_32){_31.push(_32);if(_31.length>10){_31.shift();}},remove:function(_33){var s=[];for(var i=0,len=_31.length;i<len;i++){if(_31[i]!=_33){s.push(_31[i]);}}_31=s;},next:function(){return _31.pop();}};};
